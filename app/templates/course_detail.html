{% extends "layouts/base.html" %}
{% from "components/course_header.html" import course_header %}
{% from "components/evaluation_accordion.html" import evaluation_accordion %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/course-detail.css') }}" />
<link rel="stylesheet" href="{{ url_for('static', filename='css/landing.css') }}" />
{% endblock %}

{% block navbar %}
<!-- Sin navbar en la página del curso -->
{% endblock %}

{% block title %}{{ course_name }} - Calculadora de Notas{% endblock %}

{% block content %}

<!-- Course Header -->
{{ course_header(course_name, course_code, icon_gradient, icon_svg) }}

<!-- Main Content -->
<div class="course-content">
  <!-- Left Side: Chart Area (70%) -->
  <div class="chart-section">
    <div class="chart-container">
      <!-- Basic Mode Chart -->
      <div class="chart-placeholder chart-basic">
        <svg width="120" height="120" viewBox="0 0 120 120" fill="none">
          <rect
            x="10"
            y="80"
            width="15"
            height="30"
            fill="var(--blue-200)"
            rx="2"
          />
          <rect
            x="30"
            y="60"
            width="15"
            height="50"
            fill="var(--blue-300)"
            rx="2"
          />
          <rect
            x="50"
            y="40"
            width="15"
            height="70"
            fill="var(--blue-400)"
            rx="2"
          />
          <rect
            x="70"
            y="30"
            width="15"
            height="80"
            fill="var(--blue-500)"
            rx="2"
          />
          <rect
            x="90"
            y="20"
            width="15"
            height="90"
            fill="var(--blue-600)"
            rx="2"
          />
        </svg>
        <p class="chart-placeholder-text">Tu promedio actual</p>
        <h2 class="chart-placeholder-value">--</h2>
        <p class="chart-placeholder-label">Avance: 0%</p>
        <div class="chart-placeholder-requirement">
          <p class="requirement-text">
            Para alcanzar tu meta de <strong>55</strong>
          </p>
          <h3 class="requirement-value">55.0</h3>
          <p class="requirement-subtext">necesitas en el 100% restante</p>
        </div>
      </div>

      <!-- Advanced Mode Chart -->
      <div class="chart-placeholder chart-advanced" style="display: none;">
        <svg width="600" height="400" viewBox="0 0 600 400" fill="none">
          <!-- Grid lines -->
          <line x1="50" y1="50" x2="50" y2="350" stroke="var(--slate-300)" stroke-width="2"/>
          <line x1="50" y1="350" x2="550" y2="350" stroke="var(--slate-300)" stroke-width="2"/>
          
          <!-- Grid horizontal lines -->
          <line x1="50" y1="50" x2="550" y2="50" stroke="var(--slate-200)" stroke-width="1" stroke-dasharray="5,5"/>
          <line x1="50" y1="125" x2="550" y2="125" stroke="var(--slate-200)" stroke-width="1" stroke-dasharray="5,5"/>
          <line x1="50" y1="200" x2="550" y2="200" stroke="var(--slate-200)" stroke-width="1" stroke-dasharray="5,5"/>
          <line x1="50" y1="275" x2="550" y2="275" stroke="var(--slate-200)" stroke-width="1" stroke-dasharray="5,5"/>
          
          <!-- Contour lines -->
          <path d="M 50 320 Q 200 280, 350 240 T 550 180" stroke="var(--emerald-500)" stroke-width="3" fill="none" opacity="0.8"/>
          <path d="M 50 280 Q 200 240, 350 200 T 550 140" stroke="var(--blue-500)" stroke-width="3" fill="none" opacity="0.8"/>
          <path d="M 50 240 Q 200 200, 350 160 T 550 100" stroke="var(--indigo-600)" stroke-width="3" fill="none" opacity="0.8"/>
          <path d="M 50 200 Q 200 160, 350 120 T 550 60" stroke="var(--violet-500)" stroke-width="3" fill="none" opacity="0.8"/>
          
          <!-- Labels -->
          <text x="560" y="185" fill="var(--emerald-500)" font-size="14" font-weight="600">55</text>
          <text x="560" y="145" fill="var(--blue-500)" font-size="14" font-weight="600">70</text>
          <text x="560" y="105" fill="var(--indigo-600)" font-size="14" font-weight="600">80</text>
          <text x="560" y="65" fill="var(--violet-500)" font-size="14" font-weight="600">90</text>
          
          <!-- Axis labels -->
          <text x="300" y="380" fill="var(--slate-600)" font-size="12" text-anchor="middle">Evaluación 1</text>
          <text x="20" y="200" fill="var(--slate-600)" font-size="12" text-anchor="middle" transform="rotate(-90 20 200)">Evaluación 2</text>
          
          <!-- Y-axis values -->
          <text x="35" y="55" fill="var(--slate-500)" font-size="10" text-anchor="end">100</text>
          <text x="35" y="130" fill="var(--slate-500)" font-size="10" text-anchor="end">75</text>
          <text x="35" y="205" fill="var(--slate-500)" font-size="10" text-anchor="end">50</text>
          <text x="35" y="280" fill="var(--slate-500)" font-size="10" text-anchor="end">25</text>
          <text x="35" y="355" fill="var(--slate-500)" font-size="10" text-anchor="end">0</text>
          
          <!-- X-axis values -->
          <text x="50" y="370" fill="var(--slate-500)" font-size="10" text-anchor="middle">0</text>
          <text x="175" y="370" fill="var(--slate-500)" font-size="10" text-anchor="middle">25</text>
          <text x="300" y="370" fill="var(--slate-500)" font-size="10" text-anchor="middle">50</text>
          <text x="425" y="370" fill="var(--slate-500)" font-size="10" text-anchor="middle">75</text>
          <text x="550" y="370" fill="var(--slate-500)" font-size="10" text-anchor="middle">100</text>
        </svg>
        <p class="chart-advanced-description">
          Gráfico de curvas de nivel mostrando combinaciones de notas<br/>
          para alcanzar diferentes objetivos de aprobación
        </p>
      </div>
    </div>
  </div>

  <!-- Right Side: Evaluations Panel (35%) -->
  <div class="evaluations-section">
    <div class="evaluations-header">
      <h2 class="evaluations-title">Evaluaciones</h2>
    </div>

    <!-- Certámenes -->
    {{ evaluation_accordion('Certamen 1', 25, 'exam') }}
    {{ evaluation_accordion('Certamen 2', 25, 'exam') }}
    {{ evaluation_accordion('Certamen 3', 25, 'exam') }}
    
    <!-- Tareas -->
    {{ evaluation_accordion('Tareas', 15, 'task') }}
    
    <!-- Controles -->
    {{ evaluation_accordion('Controles', 10, 'book') }}
  </div>
</div>

<script src="{{ url_for('static', filename='js/course_detail.js') }}"></script>
{% endblock %}
